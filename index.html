<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>Petition Pinger</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/4.4.4/d3.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/rxjs/5.0.1/Rx.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.4/lodash.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.6/handlebars.min.js"></script>

  <style>
    path.constituency {
      transition: fill 3s ease;
    }
    #main {
      display: -ms-flex;
      display: -webkit-flex;
      display: flex;
      height:600px;
    }
    #outlet {
      min-width: 400px;
      height: 600px;
      width: 32%;
    }
    #outlet svg {
      margin:auto;
      display:block;
    }
    #votes {
      min-width:200px;
      width:67%;
      height:600px;
    }
    table {
      width:100%;
      border-collapse: collapse;
    }
    td, th {
      border: 1px solid #999;
      padding: 5px;
      text-align: left;
    }
    .new-entry {
      background-color: green;
    }
    .moving-up:after {
      content: ' \2191 ';
      color:green;
    }
    .moving-down:after {
      content: ' \2193 ';
      color:red;
    }
    .steady:after {
      content: ' \2194 ';
    }
    .highlight {
      transition: none !important;
      fill:green !important;
    }
    .constituency-name {
      cursor: pointer;
    }
  </style>
</head>
<body>
<h1>Petition Pinger</h1>
<p>
I was amazed at how quickly <a href="https://petition.parliament.uk/petitions/171928" target="_blank">this petition</a> was being signed and noticed that the data is <a href="https://petition.parliament.uk/petitions/171928.json" target="_blank">published as JSON</a> so decided to see where the votes were coming from.

You can see the code I used <a href="https://github.com/pauldambra/petition-pinger" target="_blank">on Github</a>. It could be amended for any petition.
<p>
  <p>Now tracking <a href="https://petition.parliament.uk/petitions/223729">Rescind Art.50 if Vote Leave has broken Electoral Laws regarding 2016 referendum</a></p>
<div id="main">
  <div id="outlet">
    <svg></svg>
  </div>
  <div id="votes">
  </div>
</div>


<script id="leaderboard-template" type="text/x-handlebars-template">
  <h1>
    Top 20 Consituencies by Votes
  </h1>
  <table>
      <thead>
          <th>Constituency</th>
          <th>Votes</th>
      </thead>
      <tbody>
          {{#leaders}}
          <tr {{newEntry}}>
              <td class="constituency-name"
                  data>
                  {{name}}
              </td>
              <td>
                <span {{movement}}
                    data-position="{{position}}"
                    data-last-position="{{lastPosition}}">
                  {{signature_count}}
                </span>
              </td>
          </tr>
          {{/leaders}}
      </tbody>
  </table>
</script>

  <script src="uk.electionmap.d3.js"></script>
  <script src="hoverer.js"></script>
  <script src="pinger.js"></script>

  <script>
    var svg = d3.select('#outlet svg')
                .attr('height', 500)
                .attr('width', 400);
    window.map = UK.ElectionMap();
    window.map = window.map.edgeLength(6);
    window.map = window.map.constituencyIdentifier(window.constituencies.makeNameSafe);
    window.map(svg);
  </script>
</body>
</html>
